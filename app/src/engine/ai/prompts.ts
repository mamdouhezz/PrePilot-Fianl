/**
 * AI Prompts Module
 * Contains all prompt-building functions for AI interactions
 */

/**
 * Builds the main orchestrator prompt for AI content generation
 * Now enhanced with Audience Intelligence context
 */
export const buildOrchestratorPrompt = (payload: any) => {
  const audiencePersonaSection = `
**تحليل شخصية الجمهور المستهدف (سياق حاسم - يجب استخدامه):**
فيما يلي تحليل مفصل لشخصية الجمهور المستهدف الذي يجب أن تخصص استجابتك له:
"""
${payload.audiencePersonaSummary}
"""

**تعليمات إلزامية للسياق الجماهيري:**
1. **السرد الاستراتيجي:** يجب أن يتحدث سردك الاستراتيجي مباشرة إلى التحديات والفرص للوصول إلى هذه الشخصية المحددة.
2. **التوصيات:** يجب أن تكون توصياتك ذات صلة عالية بهذه الشخصية. على سبيل المثال، إذا كان تفضيلهم هو "المحتوى القصير"، يجب أن تركز توصياتك الإبداعية على تيك توك/الريلز. إذا كان دافعهم هو "الثقة"، أوصِ بالإعلانات التي تحتوي على شهادات.
3. **النبرة:** اضبط نبرتك لتتناسب مع الشخصية. كن أكثر حيوية للجمهور الأصغر (18-24)، وأكثر رسمية ومدفوعة بالبيانات للجمهور الأكبر (45+).
4. **المنصات:** ركز توصياتك على المنصات المفضلة للجمهور المحدد.
5. **المحتوى:** اقترح أنواع المحتوى التي تتناسب مع تفضيلات الجمهور وسلوك التحويل.
`;

  const fullPrompt = `
أنت "PrePilot AI" - خبير تسويق رقمي متخصص في السوق السعودي. مهمتك هي تحليل بيانات الحملة الإعلانية وتقديم تقرير شامل ومفصل.

${audiencePersonaSection}

**بيانات الحملة الكاملة للتحليل:**
${JSON.stringify(payload, null, 2)}

**متطلبات التقرير:**
1. قدم سرداً استراتيجياً يربط بين أهداف الحملة وشخصية الجمهور المستهدف
2. قدم توصيات عملية ومحددة تركز على المنصات والمحتوى المناسب للجمهور
3. اشرح التوقعات والأرقام بطريقة واضحة ومفهومة
4. استخدم نبرة مناسبة لشخصية الجمهور المستهدف
5. ركز على الفرص والتحديات الخاصة بهذا الجمهور المحدد

**تنسيق الاستجابة المطلوب:**
{
  "confidence": عدد من 0 إلى 1 يمثل ثقتك في التحليل,
  "narrative": "السرد الاستراتيجي للحملة",
  "recommendations": ["التوصية الأولى", "التوصية الثانية", "التوصية الثالثة"],
  "explainability": {
    "توزيع الميزانية": "شرح توزيع الميزانية",
    "تقدير العائد (ROAS)": "شرح تقدير العائد",
    "تكلفة اكتساب العميل (CAC)": "شرح تكلفة اكتساب العميل"
  },
  "generatedUiWarnings": [
    {
      "code": "كود التحذير",
      "message": "رسالة التحذير المخصصة"
    }
  ]
}

**تذكر:** كل توصية يجب أن تكون مخصصة لشخصية الجمهور المحددة أعلاه.
`;

  return fullPrompt;
};

/**
 * Builds UI warning prompt for generating user-friendly messages
 */
export const buildUIWarningPrompt = (warnings: any) => 
  `Generate user-friendly messages for these warnings: ${JSON.stringify(warnings)}`;
