# ğŸ“Š Ù…Ø®Ø·Ø· Ù…Ø¹Ù…Ø§Ø±ÙŠØ© ØªØ·Ø¨ÙŠÙ‚ PrePilot v3

## ğŸ—ï¸ Ø§Ù„Ù…Ø®Ø·Ø· Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ

```
                    ğŸ“± PrePilot v3 Application (App.tsx)
                                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                       â”‚                       â”‚
    pages/ (5)          components/ (60+)          engine/ (25+)
        â”‚                       â”‚                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Playground   â”‚       â”‚   ui/ (15+)   â”‚       â”‚ prepilotEngineâ”‚
â”‚  ResultsDash  â”‚       â”‚ report/ (15+) â”‚       â”‚ kpi/          â”‚
â”‚  ExportCenter â”‚       â”‚ results/ (5+) â”‚       â”‚ ai/           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## âš™ï¸ Ù…Ø­Ø±Ùƒ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø¹ÙŠØ§Ø±ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯ (Modular Engine Architecture)

```
                    ğŸ¯ engine/index.ts (Public API)
                           â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                  â”‚                              â”‚
    ğŸ“ core/           ğŸ“ modules/                    ğŸ“ validation/
        â”‚                  â”‚                              â”‚
   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
   â”‚prepilot.â”‚        â”‚ kpiCalc â”‚                  â”‚   rules     â”‚
   â”‚ engine  â”‚        â”‚ budget  â”‚                  â”‚ guardrails  â”‚
   â”‚(orchestrator)â”‚   â”‚competitorâ”‚                â”‚ preflight   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚                              â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                    ğŸ“ ai/
                                    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
                                    â”‚ prompts â”‚
                                    â”‚generatorsâ”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Ù†Ø¸Ø§Ù… Ø³ÙŠØ± Ø§Ù„Ø¹Ù…Ù„ (Workflow System) - (Zustand-based)

```
                     ğŸ”„ Asynchronous Workflow System
                                â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚         ğŸª exportStore.ts         â”‚
              â”‚   (Zustand State Management)      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                       â”‚                       â”‚
    Actions (UI)        State & Logic (Store)     Async Processor
        â”‚                       â”‚                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
â”‚ addToQueue()  â”‚       â”‚ exportQueue[] â”‚       â”‚ processQueue()â”‚
â”‚ retryTask()   â”‚       â”‚ drafts[]      â”‚       â”‚ (setInterval) â”‚
â”‚ publishPost() â”‚       â”‚ published[]   â”‚       â”‚ AI Call       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                        UI Components (Real-time updates)
```

## ğŸ§© Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª (Component Hierarchy)

```
                    ğŸ¯ App.tsx (State: currentPage)
                           â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                     â”‚
 
   ğŸ¨ DashboardLayout                ğŸ“Š ResultsDashboardPage
        â”‚                                     â”‚ (Receives reportId, nav functions)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Header     â”‚                       â”‚ ğŸ¨ ResultsLayout â”‚
â”‚    Sidebar    â”‚                       â”‚     (Layout)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                 â”‚
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚                                 â”‚
                         ğŸ”§ ResultsToolbar              ğŸ“„ Report Sections
                                â”‚                                 â”‚ (e.g., MediaPlan)
                           (Receives onClick          (Receives report data)
                             handlers)
```

## ğŸ”— ØªØ¯ÙÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Data Flow)

```
1. User Input â†’ PlaygroundPage â†’ onGeneratePlan(data) â†’ App.tsx
                                                         â”‚
                                                         â–¼
2. App.tsx â†’ engine.runCampaign(data) â†’ returns CampaignReport
                                                         â”‚
                                                         â–¼
3. App.tsx â†’ reportStore.setReport(id, report) â†’ navigateTo('results-dashboard')
                                                         â”‚
                                                         â–¼
4. ResultsDashboardPage â†’ reads report from reportStore â†’ Renders Report Components
                                                         â”‚
                                                         â–¼
5. Export Button Click â†’ exportStore.addToQueue(task) â†’ UI updates from store state
```

## ğŸ¨ Ø·Ø¨Ù‚Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ (Application Layers)

```
                    ğŸ¨ Presentation Layer (React Components)
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ pages/, components/                      â”‚
                    â”‚ (Handles UI, layout, and user events)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                    ğŸª State Management Layer (Zustand)
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ stores/ (reportStore, exportStore)       â”‚
                    â”‚ (Central source of truth, async logic)   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                    âš™ï¸ Business Logic Layer (Engine & Services)
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ engine/, services/                       â”‚
                    â”‚ (Calculations, AI calls, validations)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                    ğŸ’¾ Data Layer (Constants & Types)
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ constants/, types/                       â”‚
                    â”‚ (Static data, benchmarks, TypeScript definitions)â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

*ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø®Ø·Ø· ÙÙŠ: ${new Date().toLocaleDateString('ar-SA')}*
*Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${new Date().toLocaleString('ar-SA')}*
